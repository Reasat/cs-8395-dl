2020-01-14-04-40-20
train_hm.py
--------------------------------------------------------------------------------------------------------------------
alpha: 0.7
batchSize: 16
bottleneckFeatures: 0
dir_lf: D:\Data\cs-8395-dl
dir_project: C:\Users\Reasat\Projects\cs-8395-dl\Assignment_1_detection
encoder: hm_net
epoch: 100
folderData: assignment1_data
gamma: 2
lr: 0.001
resume_from: None
--------------------------------------------------------------------------------------------------------------------
creating directory to save model at D:\Data\cs-8395-dl\model\2020-01-14-04-40-20
loading images to RAM
train samples 105
loading images to RAM
validation samples 10
HM_Net(
  (conv1): conv_bn_3x3(
    (block): Sequential(
      (0): Conv2d(3, 8, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (1): ReLU()
      (2): BatchNorm2d(8, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
  )
  (conv2): conv_bn_3x3(
    (block): Sequential(
      (0): Conv2d(8, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (1): ReLU()
      (2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
  )
  (conv3): conv_bn_3x3(
    (block): Sequential(
      (0): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (1): ReLU()
      (2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
  )
  (conv4): conv_bn_3x3(
    (block): Sequential(
      (0): Conv2d(16, 8, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (1): ReLU()
      (2): BatchNorm2d(8, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
  )
  (conv5): conv_bn_3x3(
    (block): Sequential(
      (0): Conv2d(8, 1, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (1): ReLU()
      (2): BatchNorm2d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
  )
)
train >>> epoch: 1/100, batch: 1/7, mean_loss: 0.9690
train >>> epoch: 1/100, batch: 2/7, mean_loss: 0.9328
train >>> epoch: 1/100, batch: 3/7, mean_loss: 0.8767
train >>> epoch: 1/100, batch: 4/7, mean_loss: 0.8164
train >>> epoch: 1/100, batch: 5/7, mean_loss: 0.7692
train >>> epoch: 1/100, batch: 6/7, mean_loss: 0.7351
train >>> epoch: 1/100, batch: 7/7, mean_loss: 0.6857
valid >>> epoch: 1/100, mean_loss: 0.1182
criteria decreased from inf to 0.1182, saving best model at D:\Data\cs-8395-dl\model\2020-01-14-04-40-20\2020-01-14-04-40-20_hm_net_best.pt
train >>> epoch: 2/100, batch: 1/7, mean_loss: 0.3480
train >>> epoch: 2/100, batch: 2/7, mean_loss: 0.3392
train >>> epoch: 2/100, batch: 3/7, mean_loss: 0.3141
train >>> epoch: 2/100, batch: 4/7, mean_loss: 0.2887
train >>> epoch: 2/100, batch: 5/7, mean_loss: 0.2732
train >>> epoch: 2/100, batch: 6/7, mean_loss: 0.2608
train >>> epoch: 2/100, batch: 7/7, mean_loss: 0.2615
valid >>> epoch: 2/100, mean_loss: 0.1306
train >>> epoch: 3/100, batch: 1/7, mean_loss: 0.1723
train >>> epoch: 3/100, batch: 2/7, mean_loss: 0.1749
train >>> epoch: 3/100, batch: 3/7, mean_loss: 0.1723
train >>> epoch: 3/100, batch: 4/7, mean_loss: 0.1684
train >>> epoch: 3/100, batch: 5/7, mean_loss: 0.1651
train >>> epoch: 3/100, batch: 6/7, mean_loss: 0.1644
train >>> epoch: 3/100, batch: 7/7, mean_loss: 0.1639
valid >>> epoch: 3/100, mean_loss: 0.1403
train >>> epoch: 4/100, batch: 1/7, mean_loss: 0.1576
train >>> epoch: 4/100, batch: 2/7, mean_loss: 0.1482
train >>> epoch: 4/100, batch: 3/7, mean_loss: 0.1485
train >>> epoch: 4/100, batch: 4/7, mean_loss: 0.1476
train >>> epoch: 4/100, batch: 5/7, mean_loss: 0.1486
train >>> epoch: 4/100, batch: 6/7, mean_loss: 0.1486
train >>> epoch: 4/100, batch: 7/7, mean_loss: 0.1478
valid >>> epoch: 4/100, mean_loss: 0.1340
train >>> epoch: 5/100, batch: 1/7, mean_loss: 0.1389
train >>> epoch: 5/100, batch: 2/7, mean_loss: 0.1349
train >>> epoch: 5/100, batch: 3/7, mean_loss: 0.1371
train >>> epoch: 5/100, batch: 4/7, mean_loss: 0.1395
train >>> epoch: 5/100, batch: 5/7, mean_loss: 0.1409
train >>> epoch: 5/100, batch: 6/7, mean_loss: 0.1420
train >>> epoch: 5/100, batch: 7/7, mean_loss: 0.1411
valid >>> epoch: 5/100, mean_loss: 0.1310
train >>> epoch: 6/100, batch: 1/7, mean_loss: 0.1336
train >>> epoch: 6/100, batch: 2/7, mean_loss: 0.1357
train >>> epoch: 6/100, batch: 3/7, mean_loss: 0.1348
train >>> epoch: 6/100, batch: 4/7, mean_loss: 0.1330
train >>> epoch: 6/100, batch: 5/7, mean_loss: 0.1343
train >>> epoch: 6/100, batch: 6/7, mean_loss: 0.1362
train >>> epoch: 6/100, batch: 7/7, mean_loss: 0.1373
valid >>> epoch: 6/100, mean_loss: 0.1301
train >>> epoch: 7/100, batch: 1/7, mean_loss: 0.1140
train >>> epoch: 7/100, batch: 2/7, mean_loss: 0.1254
train >>> epoch: 7/100, batch: 3/7, mean_loss: 0.1285
train >>> epoch: 7/100, batch: 4/7, mean_loss: 0.1325
train >>> epoch: 7/100, batch: 5/7, mean_loss: 0.1321
train >>> epoch: 7/100, batch: 6/7, mean_loss: 0.1340
train >>> epoch: 7/100, batch: 7/7, mean_loss: 0.1334
valid >>> epoch: 7/100, mean_loss: 0.1315
train >>> epoch: 8/100, batch: 1/7, mean_loss: 0.1433
train >>> epoch: 8/100, batch: 2/7, mean_loss: 0.1367
train >>> epoch: 8/100, batch: 3/7, mean_loss: 0.1381
train >>> epoch: 8/100, batch: 4/7, mean_loss: 0.1380
train >>> epoch: 8/100, batch: 5/7, mean_loss: 0.1355
train >>> epoch: 8/100, batch: 6/7, mean_loss: 0.1328
train >>> epoch: 8/100, batch: 7/7, mean_loss: 0.1336
valid >>> epoch: 8/100, mean_loss: 0.1248
train >>> epoch: 9/100, batch: 1/7, mean_loss: 0.1370
train >>> epoch: 9/100, batch: 2/7, mean_loss: 0.1346
train >>> epoch: 9/100, batch: 3/7, mean_loss: 0.1320
train >>> epoch: 9/100, batch: 4/7, mean_loss: 0.1311
train >>> epoch: 9/100, batch: 5/7, mean_loss: 0.1286
train >>> epoch: 9/100, batch: 6/7, mean_loss: 0.1276
train >>> epoch: 9/100, batch: 7/7, mean_loss: 0.1270
valid >>> epoch: 9/100, mean_loss: 0.1196
train >>> epoch: 10/100, batch: 1/7, mean_loss: 0.1294
train >>> epoch: 10/100, batch: 2/7, mean_loss: 0.1286
train >>> epoch: 10/100, batch: 3/7, mean_loss: 0.1244
train >>> epoch: 10/100, batch: 4/7, mean_loss: 0.1239
train >>> epoch: 10/100, batch: 5/7, mean_loss: 0.1247
train >>> epoch: 10/100, batch: 6/7, mean_loss: 0.1230
train >>> epoch: 10/100, batch: 7/7, mean_loss: 0.1229
valid >>> epoch: 10/100, mean_loss: 0.1018
criteria decreased from 0.1182 to 0.1018, saving best model at D:\Data\cs-8395-dl\model\2020-01-14-04-40-20\2020-01-14-04-40-20_hm_net_best.pt
train >>> epoch: 11/100, batch: 1/7, mean_loss: 0.1151
train >>> epoch: 11/100, batch: 2/7, mean_loss: 0.1143
train >>> epoch: 11/100, batch: 3/7, mean_loss: 0.1148
train >>> epoch: 11/100, batch: 4/7, mean_loss: 0.1156
train >>> epoch: 11/100, batch: 5/7, mean_loss: 0.1178
train >>> epoch: 11/100, batch: 6/7, mean_loss: 0.1170
train >>> epoch: 11/100, batch: 7/7, mean_loss: 0.1187
valid >>> epoch: 11/100, mean_loss: 0.0958
criteria decreased from 0.1018 to 0.0958, saving best model at D:\Data\cs-8395-dl\model\2020-01-14-04-40-20\2020-01-14-04-40-20_hm_net_best.pt
train >>> epoch: 12/100, batch: 1/7, mean_loss: 0.1140
train >>> epoch: 12/100, batch: 2/7, mean_loss: 0.1153
train >>> epoch: 12/100, batch: 3/7, mean_loss: 0.1187
train >>> epoch: 12/100, batch: 4/7, mean_loss: 0.1175
train >>> epoch: 12/100, batch: 5/7, mean_loss: 0.1158
train >>> epoch: 12/100, batch: 6/7, mean_loss: 0.1144
train >>> epoch: 12/100, batch: 7/7, mean_loss: 0.1118
valid >>> epoch: 12/100, mean_loss: 0.0936
criteria decreased from 0.0958 to 0.0936, saving best model at D:\Data\cs-8395-dl\model\2020-01-14-04-40-20\2020-01-14-04-40-20_hm_net_best.pt
train >>> epoch: 13/100, batch: 1/7, mean_loss: 0.1045
train >>> epoch: 13/100, batch: 2/7, mean_loss: 0.1063
train >>> epoch: 13/100, batch: 3/7, mean_loss: 0.1047
train >>> epoch: 13/100, batch: 4/7, mean_loss: 0.1025
train >>> epoch: 13/100, batch: 5/7, mean_loss: 0.0997
train >>> epoch: 13/100, batch: 6/7, mean_loss: 0.0986
train >>> epoch: 13/100, batch: 7/7, mean_loss: 0.0966
valid >>> epoch: 13/100, mean_loss: 0.0963
train >>> epoch: 14/100, batch: 1/7, mean_loss: 0.0886
train >>> epoch: 14/100, batch: 2/7, mean_loss: 0.0988
train >>> epoch: 14/100, batch: 3/7, mean_loss: 0.0975
train >>> epoch: 14/100, batch: 4/7, mean_loss: 0.0955
train >>> epoch: 14/100, batch: 5/7, mean_loss: 0.0970
train >>> epoch: 14/100, batch: 6/7, mean_loss: 0.0954
train >>> epoch: 14/100, batch: 7/7, mean_loss: 0.0930
valid >>> epoch: 14/100, mean_loss: 0.0971
train >>> epoch: 15/100, batch: 1/7, mean_loss: 0.0744
train >>> epoch: 15/100, batch: 2/7, mean_loss: 0.0866
train >>> epoch: 15/100, batch: 3/7, mean_loss: 0.0909
train >>> epoch: 15/100, batch: 4/7, mean_loss: 0.0902
train >>> epoch: 15/100, batch: 5/7, mean_loss: 0.0883
train >>> epoch: 15/100, batch: 6/7, mean_loss: 0.0873
train >>> epoch: 15/100, batch: 7/7, mean_loss: 0.0949
valid >>> epoch: 15/100, mean_loss: 0.0933
criteria decreased from 0.0936 to 0.0933, saving best model at D:\Data\cs-8395-dl\model\2020-01-14-04-40-20\2020-01-14-04-40-20_hm_net_best.pt
train >>> epoch: 16/100, batch: 1/7, mean_loss: 0.0824
train >>> epoch: 16/100, batch: 2/7, mean_loss: 0.0871
train >>> epoch: 16/100, batch: 3/7, mean_loss: 0.0831
train >>> epoch: 16/100, batch: 4/7, mean_loss: 0.0831
train >>> epoch: 16/100, batch: 5/7, mean_loss: 0.0869
train >>> epoch: 16/100, batch: 6/7, mean_loss: 0.0873
train >>> epoch: 16/100, batch: 7/7, mean_loss: 0.0864
valid >>> epoch: 16/100, mean_loss: 0.0920
criteria decreased from 0.0933 to 0.0920, saving best model at D:\Data\cs-8395-dl\model\2020-01-14-04-40-20\2020-01-14-04-40-20_hm_net_best.pt
train >>> epoch: 17/100, batch: 1/7, mean_loss: 0.0863
train >>> epoch: 17/100, batch: 2/7, mean_loss: 0.0766
train >>> epoch: 17/100, batch: 3/7, mean_loss: 0.0758
train >>> epoch: 17/100, batch: 4/7, mean_loss: 0.0763
train >>> epoch: 17/100, batch: 5/7, mean_loss: 0.0775
train >>> epoch: 17/100, batch: 6/7, mean_loss: 0.0790
train >>> epoch: 17/100, batch: 7/7, mean_loss: 0.0796
valid >>> epoch: 17/100, mean_loss: 0.0915
criteria decreased from 0.0920 to 0.0915, saving best model at D:\Data\cs-8395-dl\model\2020-01-14-04-40-20\2020-01-14-04-40-20_hm_net_best.pt
train >>> epoch: 18/100, batch: 1/7, mean_loss: 0.0731
train >>> epoch: 18/100, batch: 2/7, mean_loss: 0.0740
train >>> epoch: 18/100, batch: 3/7, mean_loss: 0.0776
train >>> epoch: 18/100, batch: 4/7, mean_loss: 0.0804
train >>> epoch: 18/100, batch: 5/7, mean_loss: 0.0791
train >>> epoch: 18/100, batch: 6/7, mean_loss: 0.0800
train >>> epoch: 18/100, batch: 7/7, mean_loss: 0.0799
valid >>> epoch: 18/100, mean_loss: 0.0881
criteria decreased from 0.0915 to 0.0881, saving best model at D:\Data\cs-8395-dl\model\2020-01-14-04-40-20\2020-01-14-04-40-20_hm_net_best.pt
train >>> epoch: 19/100, batch: 1/7, mean_loss: 0.0917
train >>> epoch: 19/100, batch: 2/7, mean_loss: 0.0862
train >>> epoch: 19/100, batch: 3/7, mean_loss: 0.0834
train >>> epoch: 19/100, batch: 4/7, mean_loss: 0.0785
train >>> epoch: 19/100, batch: 5/7, mean_loss: 0.0795
train >>> epoch: 19/100, batch: 6/7, mean_loss: 0.0769
train >>> epoch: 19/100, batch: 7/7, mean_loss: 0.0769
valid >>> epoch: 19/100, mean_loss: 0.0853
criteria decreased from 0.0881 to 0.0853, saving best model at D:\Data\cs-8395-dl\model\2020-01-14-04-40-20\2020-01-14-04-40-20_hm_net_best.pt
train >>> epoch: 20/100, batch: 1/7, mean_loss: 0.0687
train >>> epoch: 20/100, batch: 2/7, mean_loss: 0.0760
