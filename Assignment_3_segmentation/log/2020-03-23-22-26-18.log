2020-03-23-22-26-18
train.py
--------------------------------------------------------------------------------------------------------------------
axis: axial
batchSize: 12
bottleneckFeatures: 0
brightness: None
contrast: None
cropSize: None
dir_lf: D:\Data\cs-8395-dl
dir_project: ..
encoder: dpn68
epoch: 24
extract_spleen: False
folderData: assignment3\Training
folderPartition: train_test_org
lossWeight: [0.3, 0.7]
loss_weights: None
lr: 1e-05
msg: None
overrideLR: 1
path_kfold: D:\Projects\cs-8395-dl\Assignment_3_segmentation\partition\kfold_5.bin
resize: None
resume_from: D:\Data\cs-8395-dl\model\2020-03-23-07-39-40\2020-03-23-07-39-40_1_fold-dpn68_best.pt
to_ram: 0
--------------------------------------------------------------------------------------------------------------------
creating directory to save model at D:\Data\cs-8395-dl\model\2020-03-23-22-26-18
executing fold 1/5
training patients  ['0001' '0002' '0003' '0004' '0005' '0006' '0007' '0008' '0021' '0022'
 '0023' '0024' '0025' '0027' '0029' '0030' '0031' '0032' '0033' '0035'
 '0036' '0037' '0039' '0040']
validation patients  ['0009' '0010' '0026' '0028' '0034' '0038']
loaded model weights from D:\Data\cs-8395-dl\model\2020-03-23-07-39-40\2020-03-23-07-39-40_1_fold-dpn68_best.pt
epoch 1
validation loss of pretrained model: 0.3643
tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], device='cuda:0')
tensor([[0.3504, 0.7050],
        [0.4845, 0.5836],
        [0.4771, 0.5890],
        [0.4077, 0.6540],
        [0.4016, 0.6579],
        [0.3495, 0.7107],
        [0.4077, 0.6540],
        [0.3504, 0.7050],
        [0.4152, 0.6473],
        [0.3495, 0.7107],
        [0.4771, 0.5890],
        [0.3504, 0.7050]], device='cuda:0', grad_fn=<SigmoidBackward>)
tensor(0.3127, device='cuda:0', grad_fn=<NllLossBackward>)
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
tensor([[0.8639, 0.1879],
        [0.8632, 0.1854],
        [0.8669, 0.1774],
        [0.8669, 0.1774],
        [0.8600, 0.1887],
        [0.8528, 0.1987],
        [0.8800, 0.1614],
        [0.8894, 0.1530],
        [0.8894, 0.1530],
        [0.8551, 0.1922],
        [0.8639, 0.1879],
        [0.8669, 0.1774]], device='cuda:0', grad_fn=<SigmoidBackward>)
tensor(0.0328, device='cuda:0', grad_fn=<NllLossBackward>)
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
tensor([[0.8404, 0.2127],
        [0.8745, 0.1713],
        [0.8745, 0.1713],
        [0.8839, 0.1568],
        [0.8404, 0.2127],
        [0.8828, 0.1581],
        [0.8404, 0.2127],
        [0.9041, 0.1364],
        [0.8728, 0.1734],
        [0.8404, 0.2127],
        [0.8728, 0.1734],
        [0.8828, 0.1581]], device='cuda:0', grad_fn=<SigmoidBackward>)
tensor(0.0341, device='cuda:0', grad_fn=<NllLossBackward>)
tensor([0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0], device='cuda:0')
tensor([[0.8322, 0.2208],
        [0.6585, 0.4120],
        [0.1207, 0.9033],
        [0.7505, 0.3070],
        [0.7574, 0.3106],
        [0.8792, 0.1617],
        [0.1207, 0.9033],
        [0.8322, 0.2208],
        [0.6215, 0.4532],
        [0.6254, 0.4484],
        [0.1222, 0.8999],
        [0.8792, 0.1617]], device='cuda:0', grad_fn=<SigmoidBackward>)
tensor(0.1034, device='cuda:0', grad_fn=<NllLossBackward>)
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
tensor([[0.8725, 0.1732],
        [0.8208, 0.2331],
        [0.8678, 0.1801],
        [0.8594, 0.1859],
        [0.8607, 0.1826],
        [0.8833, 0.1598],
        [0.8728, 0.1736],
        [0.8678, 0.1801],
        [0.8725, 0.1732],
        [0.8728, 0.1736],
        [0.8159, 0.2457],
        [0.8594, 0.1859]], device='cuda:0', grad_fn=<SigmoidBackward>)
tensor(0.0379, device='cuda:0', grad_fn=<NllLossBackward>)
tensor([0, 0, 0], device='cuda:0')
tensor([[0.8641, 0.1831],
        [0.8641, 0.1831],
        [0.8641, 0.1831]], device='cuda:0', grad_fn=<SigmoidBackward>)
tensor(0.0346, device='cuda:0', grad_fn=<NllLossBackward>)
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
tensor([[0.8659, 0.1791],
        [0.8807, 0.1640],
        [0.8659, 0.1791],
        [0.8657, 0.1804],
        [0.8807, 0.1640],
        [0.8659, 0.1791],
        [0.8478, 0.2041],
        [0.8478, 0.2041],
        [0.8659, 0.1791],
        [0.8742, 0.1712],
        [0.8807, 0.1640],
        [0.8831, 0.1623]], device='cuda:0', grad_fn=<SigmoidBackward>)
tensor(0.0325, device='cuda:0', grad_fn=<NllLossBackward>)
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
tensor([[0.8707, 0.1737],
        [0.8873, 0.1514],
        [0.8467, 0.2060],
        [0.8845, 0.1577],
        [0.8467, 0.2060],
        [0.8873, 0.1514],
        [0.8969, 0.1459],
        [0.8467, 0.2060],
        [0.8467, 0.2060],
        [0.8707, 0.1737],
        [0.8467, 0.2060],
        [0.8845, 0.1577]], device='cuda:0', grad_fn=<SigmoidBackward>)
tensor(0.0336, device='cuda:0', grad_fn=<NllLossBackward>)
tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], device='cuda:0')
tensor([[0.2786, 0.7726],
        [0.5541, 0.5241],
        [0.4010, 0.6671],
        [0.3470, 0.7040],
        [0.4876, 0.5838],
        [0.3753, 0.6808],
        [0.3470, 0.7040],
        [0.5541, 0.5241],
        [0.3912, 0.6653],
        [0.4876, 0.5838],
        [0.3470, 0.7040],
        [0.3470, 0.7040]], device='cuda:0', grad_fn=<SigmoidBackward>)
tensor(0.3565, device='cuda:0', grad_fn=<NllLossBackward>)
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
tensor([[0.8689, 0.1772],
        [0.8887, 0.1542],
        [0.8584, 0.1881],
        [0.8690, 0.1799],
        [0.8887, 0.1542],
        [0.8777, 0.1700],
        [0.8592, 0.1871],
        [0.8681, 0.1766],
        [0.8584, 0.1881],
        [0.8681, 0.1766],
        [0.8690, 0.1799],
        [0.8689, 0.1772]], device='cuda:0', grad_fn=<SigmoidBackward>)
tensor(0.0315, device='cuda:0', grad_fn=<NllLossBackward>)
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
tensor([[0.8577, 0.1924],
        [0.8577, 0.1924],
        [0.8884, 0.1506],
        [0.8577, 0.1924],
        [0.8328, 0.2193],
        [0.8884, 0.1506],
        [0.8884, 0.1506],
        [0.8618, 0.1882],
        [0.8861, 0.1574],
        [0.8871, 0.1568],
        [0.8577, 0.1924],
        [0.8618, 0.1882]], device='cuda:0', grad_fn=<SigmoidBackward>)
tensor(0.0330, device='cuda:0', grad_fn=<NllLossBackward>)
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
tensor([[0.8130, 0.2488],
        [0.8724, 0.1728],
        [0.7889, 0.2672],
        [0.8862, 0.1596],
        [0.7889, 0.2672],
        [0.8969, 0.1444],
        [0.7889, 0.2672],
        [0.7889, 0.2672],
        [0.8724, 0.1728],
        [0.8982, 0.1389],
        [0.8982, 0.1389],
        [0.8862, 0.1596]], device='cuda:0', grad_fn=<SigmoidBackward>)
tensor(0.0508, device='cuda:0', grad_fn=<NllLossBackward>)
tensor([1, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1], device='cuda:0')
tensor([[0.0826, 0.9353],
        [0.1756, 0.8588],
        [0.9882, 0.0178],
        [0.9135, 0.1176],
        [0.5688, 0.5028],
        [0.9882, 0.0178],
        [0.9135, 0.1176],
        [0.9567, 0.0627],
        [0.0826, 0.9353],
        [0.5688, 0.5028],
        [0.9135, 0.1176],
        [0.1756, 0.8588]], device='cuda:0', grad_fn=<SigmoidBackward>)
tensor(0.2063, device='cuda:0', grad_fn=<NllLossBackward>)
train >>> fold 1/5, epoch: 1/24, patient 1/24, mean_loss 0.1000, mean_acc 0.9744
valid >>> epoch: 1/24, mean_loss: 0.4314, mean_acc: 0.8598
criteria decreased from inf to 0.4314, saving best model at D:\Data\cs-8395-dl\model\2020-03-23-22-26-18\2020-03-23-22-26-18_dpn68_fold-1_best.pt
tensor([0, 0, 0], device='cuda:0')
tensor([[0.8711, 0.1738],
        [0.8621, 0.1862],
        [0.8621, 0.1862]], device='cuda:0', grad_fn=<SigmoidBackward>)
tensor(0.0342, device='cuda:0', grad_fn=<NllLossBackward>)
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
tensor([[0.8720, 0.1735],
        [0.8711, 0.1736],
        [0.8566, 0.1900],
        [0.8720, 0.1735],
        [0.8711, 0.1736],
        [0.8490, 0.2040],
        [0.8566, 0.1900],
        [0.8711, 0.1736],
        [0.8725, 0.1743],
        [0.8893, 0.1551],
        [0.8711, 0.1736],
        [0.8725, 0.1743]], device='cuda:0', grad_fn=<SigmoidBackward>)
tensor(0.0323, device='cuda:0', grad_fn=<NllLossBackward>)
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
tensor([[0.8645, 0.1834],
        [0.8636, 0.1846],
        [0.8606, 0.1854],
        [0.8698, 0.1770],
        [0.8636, 0.1846],
        [0.8606, 0.1854],
        [0.8698, 0.1770],
        [0.8645, 0.1834],
        [0.8895, 0.1523],
        [0.8698, 0.1770],
        [0.8895, 0.1523],
        [0.8698, 0.1770]], device='cuda:0', grad_fn=<SigmoidBackward>)
tensor(0.0319, device='cuda:0', grad_fn=<NllLossBackward>)
tensor([1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 0], device='cuda:0')
tensor([[0.0819, 0.9343],
        [0.0739, 0.9390],
        [0.9947, 0.0081],
        [0.0819, 0.9343],
        [0.0739, 0.9390],
        [0.0900, 0.9282],
        [0.9947, 0.0081],
        [0.0722, 0.9420],
        [0.9611, 0.0556],
        [0.0739, 0.9390],
        [0.9738, 0.0384],
        [0.9611, 0.0556]], device='cuda:0', grad_fn=<SigmoidBackward>)
tensor(0.0047, device='cuda:0', grad_fn=<NllLossBackward>)
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
tensor([[0.8808, 0.1631],
        [0.8764, 0.1702],
        [0.8545, 0.1946],
        [0.8577, 0.1914],
        [0.8808, 0.1636],
        [0.8545, 0.1946],
        [0.8545, 0.1946],
        [0.8808, 0.1636],
        [0.8764, 0.1702],
        [0.8808, 0.1631],
        [0.8797, 0.1602],
        [0.8577, 0.1914]], device='cuda:0', grad_fn=<SigmoidBackward>)
tensor(0.0321, device='cuda:0', grad_fn=<NllLossBackward>)
tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], device='cuda:0')
tensor([[0.3633, 0.7036],
        [0.4316, 0.6271],
        [0.4227, 0.6345],
        [0.5181, 0.5463],
        [0.3610, 0.6947],
        [0.4116, 0.6503],
        [0.3872, 0.6753],
        [0.3610, 0.6947],
        [0.4796, 0.5875],
        [0.3633, 0.7036],
        [0.4116, 0.6503],
        [0.3872, 0.6753]], device='cuda:0', grad_fn=<SigmoidBackward>)
tensor(0.3254, device='cuda:0', grad_fn=<NllLossBackward>)
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
tensor([[0.8668, 0.1797],
        [0.8660, 0.1828],
        [0.8668, 0.1797],
        [0.8761, 0.1678],
        [0.8541, 0.1964],
        [0.8814, 0.1646],
        [0.8668, 0.1797],
        [0.8668, 0.1797],
        [0.8761, 0.1678],
        [0.8777, 0.1652],
        [0.8541, 0.1964],
        [0.8777, 0.1652]], device='cuda:0', grad_fn=<SigmoidBackward>)
tensor(0.0321, device='cuda:0', grad_fn=<NllLossBackward>)
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
tensor([[0.8573, 0.1914],
        [0.9024, 0.1377],
        [0.8573, 0.1914],
        [0.8900, 0.1525],
        [0.8666, 0.1832],
        [0.8541, 0.1935],
        [0.8573, 0.1914],
        [0.8676, 0.1786],
        [0.8579, 0.1885],
        [0.8541, 0.1935],
        [0.8669, 0.1778],
        [0.9024, 0.1377]], device='cuda:0', grad_fn=<SigmoidBackward>)
tensor(0.0325, device='cuda:0', grad_fn=<NllLossBackward>)
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
tensor([[0.8286, 0.2193],
        [0.8761, 0.1679],
        [0.8686, 0.1774],
        [0.8363, 0.2193],
        [0.8761, 0.1679],
        [0.8686, 0.1774],
        [0.8824, 0.1599],
        [0.8686, 0.1774],
        [0.8363, 0.2193],
        [0.8824, 0.1599],
        [0.8761, 0.1679],
        [0.8363, 0.2193]], device='cuda:0', grad_fn=<SigmoidBackward>)
tensor(0.0373, device='cuda:0', grad_fn=<NllLossBackward>)
tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], device='cuda:0')
tensor([[0.4738, 0.5996],
        [0.3958, 0.6626],
        [0.3958, 0.6626],
        [0.3707, 0.6841],
        [0.4738, 0.5996],
        [0.3895, 0.6739],
        [0.4738, 0.5996],
        [0.3069, 0.7418],
        [0.3476, 0.7073],
        [0.4738, 0.5996],
        [0.3958, 0.6626],
        [0.3707, 0.6841]], device='cuda:0', grad_fn=<SigmoidBackward>)
tensor(0.3200, device='cuda:0', grad_fn=<NllLossBackward>)
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
tensor([[0.8808, 0.1662],
        [0.8808, 0.1662],
        [0.8235, 0.2270],
        [0.8808, 0.1662],
        [0.8235, 0.2270],
        [0.8482, 0.2034],
        [0.8128, 0.2400],
        [0.8482, 0.2034],
        [0.8482, 0.2034],
        [0.8467, 0.2004],
        [0.8808, 0.1662],
        [0.8235, 0.2270]], device='cuda:0', grad_fn=<SigmoidBackward>)
tensor(0.0449, device='cuda:0', grad_fn=<NllLossBackward>)
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
tensor([[0.8855, 0.1537],
        [0.8855, 0.1537],
        [0.8477, 0.2038],
        [0.8549, 0.1952],
        [0.8421, 0.2096],
        [0.8477, 0.2038],
        [0.8858, 0.1607],
        [0.8477, 0.2038],
        [0.8855, 0.1537],
        [0.8858, 0.1607],
        [0.8858, 0.1607],
        [0.8720, 0.1713]], device='cuda:0', grad_fn=<SigmoidBackward>)
tensor(0.0330, device='cuda:0', grad_fn=<NllLossBackward>)
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1], device='cuda:0')
tensor([[0.8970, 0.1412],
        [0.7030, 0.3674],
        [0.7510, 0.3096],
        [0.7030, 0.3674],
        [0.6746, 0.3953],
        [0.7510, 0.3096],
        [0.7030, 0.3674],
        [0.6746, 0.3953],
        [0.6754, 0.3929],
        [0.8970, 0.1412],
        [0.0751, 0.9389],
        [0.0751, 0.9389]], device='cuda:0', grad_fn=<SigmoidBackward>)
tensor(0.1239, device='cuda:0', grad_fn=<NllLossBackward>)
train >>> fold 1/5, epoch: 2/24, patient 1/24, mean_loss 0.0834, mean_acc 1.0000
