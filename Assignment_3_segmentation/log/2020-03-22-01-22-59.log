2020-03-22-01-22-59
train.py
--------------------------------------------------------------------------------------------------------------------
batchSize: 12
bottleneckFeatures: 1
brightness: None
contrast: None
cropSize: None
dir_lf: D:\Data\cs-8395-dl
dir_project: ..
encoder: resnet34
epoch: 24
extract_spleen: 1
folderData: assignment3\Training
folderPartition: train_test_org
lossWeight: [1.0, 1.0]
loss_weights: None
lr: 0.0001
msg: None
overrideLR: 1
path_kfold: D:\Projects\cs-8395-dl\Assignment_3_segmentation\partition\kfold_5.bin
resize: None
resume_from: None
resume_training: None
to_ram: 0
--------------------------------------------------------------------------------------------------------------------
creating directory to save model at D:\Data\cs-8395-dl\model\2020-03-22-01-22-59
executing fold 1/5
training patients  ['0001']
validation patients  ['0009']
train >>> epoch: 1/24, patient 1/1, mean_loss 1.7277, mean_dice_loss: 0.9532, mean_ce: 0.7745
valid >>> epoch: 1/24, mean_loss: 1.6818, mean_dice: 0.0891
criteria decreased from inf to 1.6818, saving best model at D:\Data\cs-8395-dl\model\2020-03-22-01-22-59\2020-03-22-01-22-59_1_fold-resnet34_best.pt
train >>> epoch: 2/24, patient 1/1, mean_loss 1.7230, mean_dice_loss: 0.9532, mean_ce: 0.7698
valid >>> epoch: 2/24, mean_loss: 1.6769, mean_dice: 0.0891
criteria decreased from 1.6818 to 1.6769, saving best model at D:\Data\cs-8395-dl\model\2020-03-22-01-22-59\2020-03-22-01-22-59_1_fold-resnet34_best.pt
train >>> epoch: 3/24, patient 1/1, mean_loss 1.7139, mean_dice_loss: 0.9532, mean_ce: 0.7607
valid >>> epoch: 3/24, mean_loss: 1.6613, mean_dice: 0.0891
criteria decreased from 1.6769 to 1.6613, saving best model at D:\Data\cs-8395-dl\model\2020-03-22-01-22-59\2020-03-22-01-22-59_1_fold-resnet34_best.pt
train >>> epoch: 4/24, patient 1/1, mean_loss 1.6823, mean_dice_loss: 0.9529, mean_ce: 0.7294
valid >>> epoch: 4/24, mean_loss: 1.5616, mean_dice: 0.0008
criteria decreased from 1.6613 to 1.5616, saving best model at D:\Data\cs-8395-dl\model\2020-03-22-01-22-59\2020-03-22-01-22-59_1_fold-resnet34_best.pt
train >>> epoch: 5/24, patient 1/1, mean_loss 1.4442, mean_dice_loss: 0.9443, mean_ce: 0.4999
valid >>> epoch: 5/24, mean_loss: 1.2665, mean_dice: 0.0000
criteria decreased from 1.5616 to 1.2665, saving best model at D:\Data\cs-8395-dl\model\2020-03-22-01-22-59\2020-03-22-01-22-59_1_fold-resnet34_best.pt
train >>> epoch: 6/24, patient 1/1, mean_loss 1.0946, mean_dice_loss: 0.9556, mean_ce: 0.1390
valid >>> epoch: 6/24, mean_loss: 1.7431, mean_dice: 0.0000
train >>> epoch: 7/24, patient 1/1, mean_loss 0.9349, mean_dice_loss: 0.8596, mean_ce: 0.0753
valid >>> epoch: 7/24, mean_loss: 1.4345, mean_dice: 0.0000
train >>> epoch: 8/24, patient 1/1, mean_loss 0.8609, mean_dice_loss: 0.7888, mean_ce: 0.0721
valid >>> epoch: 8/24, mean_loss: 1.4752, mean_dice: 0.0000
train >>> epoch: 9/24, patient 1/1, mean_loss 0.7911, mean_dice_loss: 0.7360, mean_ce: 0.0551
valid >>> epoch: 9/24, mean_loss: 1.7268, mean_dice: 0.0000
train >>> epoch: 10/24, patient 1/1, mean_loss 0.7158, mean_dice_loss: 0.6714, mean_ce: 0.0444
valid >>> epoch: 10/24, mean_loss: 1.7066, mean_dice: 0.0000
train >>> epoch: 11/24, patient 1/1, mean_loss 0.6564, mean_dice_loss: 0.6175, mean_ce: 0.0389
valid >>> epoch: 11/24, mean_loss: 1.8805, mean_dice: 0.0000
train >>> epoch: 12/24, patient 1/1, mean_loss 0.5948, mean_dice_loss: 0.5620, mean_ce: 0.0328
valid >>> epoch: 12/24, mean_loss: 2.4198, mean_dice: 0.0000
tensor(-0.0067, device='cuda:0', grad_fn=<MaxBackward1>)
0.4983231
