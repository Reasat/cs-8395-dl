2020-03-23-22-47-56
train.py
--------------------------------------------------------------------------------------------------------------------
axis: axial
batchSize: 12
bottleneckFeatures: 0
brightness: None
contrast: None
cropSize: None
dir_lf: D:\Data\cs-8395-dl
dir_project: ..
encoder: dpn68
epoch: 24
extract_spleen: False
folderData: assignment3\Training
folderPartition: train_test_org
lossWeight: [0.3, 0.7]
loss_weights: None
lr: 1e-05
msg: None
overrideLR: 1
path_kfold: D:\Projects\cs-8395-dl\Assignment_3_segmentation\partition\kfold_5.bin
resize: None
resume_from: D:\Data\cs-8395-dl\model\2020-03-23-07-39-40\2020-03-23-07-39-40_1_fold-dpn68_best.pt
to_ram: 0
--------------------------------------------------------------------------------------------------------------------
creating directory to save model at D:\Data\cs-8395-dl\model\2020-03-23-22-47-56
executing fold 1/5
training patients  ['0001' '0002' '0003' '0004' '0005' '0006' '0007' '0008' '0021' '0022'
 '0023' '0024' '0025' '0027' '0029' '0030' '0031' '0032' '0033' '0035'
 '0036' '0037' '0039' '0040']
validation patients  ['0009' '0010' '0026' '0028' '0034' '0038']
loaded model weights from D:\Data\cs-8395-dl\model\2020-03-23-07-39-40\2020-03-23-07-39-40_1_fold-dpn68_best.pt
epoch 1
validation loss of pretrained model: 0.3643
train samples 1
validation samples 6
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
tensor([[0.8978, 0.1428],
        [0.8878, 0.1568],
        [0.8876, 0.1581],
        [0.8941, 0.1476],
        [0.8532, 0.1985],
        [0.8699, 0.1783],
        [0.8770, 0.1675],
        [0.8514, 0.1964],
        [0.8595, 0.1870],
        [0.8482, 0.1991],
        [0.8544, 0.1925],
        [0.8487, 0.1985]], device='cuda:0', grad_fn=<SigmoidBackward>)
tensor(0.0327, device='cuda:0', grad_fn=<NllLossBackward>)
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
tensor([[0.8751, 0.1660],
        [0.8669, 0.1795],
        [0.8254, 0.2310],
        [0.8580, 0.1919],
        [0.8504, 0.2001],
        [0.8703, 0.1773],
        [0.8635, 0.1871],
        [0.8943, 0.1499],
        [0.8958, 0.1412],
        [0.8746, 0.1685],
        [0.8616, 0.1878],
        [0.8742, 0.1692]], device='cuda:0', grad_fn=<SigmoidBackward>)
tensor(0.0338, device='cuda:0', grad_fn=<NllLossBackward>)
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
tensor([[0.8632, 0.1824],
        [0.8903, 0.1533],
        [0.8552, 0.1927],
        [0.8089, 0.2457],
        [0.8395, 0.2105],
        [0.8631, 0.1872],
        [0.8635, 0.1847],
        [0.8829, 0.1625],
        [0.8676, 0.1806],
        [0.8936, 0.1480],
        [0.8911, 0.1506],
        [0.8920, 0.1457]], device='cuda:0', grad_fn=<SigmoidBackward>)
tensor(0.0343, device='cuda:0', grad_fn=<NllLossBackward>)
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
tensor([[0.8688, 0.1823],
        [0.8658, 0.1845],
        [0.8800, 0.1638],
        [0.8608, 0.1885],
        [0.8652, 0.1823],
        [0.8618, 0.1860],
        [0.8522, 0.1989],
        [0.8681, 0.1786],
        [0.8808, 0.1599],
        [0.8710, 0.1715],
        [0.8581, 0.1880],
        [0.8906, 0.1505]], device='cuda:0', grad_fn=<SigmoidBackward>)
tensor(0.0325, device='cuda:0', grad_fn=<NllLossBackward>)
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
tensor([[0.8732, 0.1703],
        [0.8627, 0.1852],
        [0.8606, 0.1883],
        [0.8465, 0.2018],
        [0.8564, 0.1910],
        [0.8758, 0.1686],
        [0.8833, 0.1557],
        [0.8637, 0.1862],
        [0.8812, 0.1655],
        [0.8991, 0.1434],
        [0.8737, 0.1707],
        [0.8474, 0.2056]], device='cuda:0', grad_fn=<SigmoidBackward>)
tensor(0.0328, device='cuda:0', grad_fn=<NllLossBackward>)
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
tensor([[0.8620, 0.1834],
        [0.8773, 0.1666],
        [0.8512, 0.1965],
        [0.8753, 0.1690],
        [0.8531, 0.1940],
        [0.8480, 0.2058],
        [0.8629, 0.1833],
        [0.8632, 0.1857],
        [0.8882, 0.1554],
        [0.8842, 0.1597],
        [0.8722, 0.1722],
        [0.8965, 0.1456]], device='cuda:0', grad_fn=<SigmoidBackward>)
tensor(0.0322, device='cuda:0', grad_fn=<NllLossBackward>)
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
tensor([[0.8418, 0.2072],
        [0.8319, 0.2213],
        [0.8643, 0.1810],
        [0.8482, 0.2011],
        [0.8681, 0.1745],
        [0.8629, 0.1822],
        [0.8823, 0.1606],
        [0.8801, 0.1656],
        [0.8889, 0.1534],
        [0.8776, 0.1687],
        [0.8822, 0.1615],
        [0.8251, 0.2357]], device='cuda:0', grad_fn=<SigmoidBackward>)
tensor(0.0366, device='cuda:0', grad_fn=<NllLossBackward>)
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
tensor([[0.8048, 0.2569],
        [0.8708, 0.1782],
        [0.8731, 0.1714],
        [0.8559, 0.1938],
        [0.8776, 0.1620],
        [0.8659, 0.1801],
        [0.8696, 0.1768],
        [0.8820, 0.1618],
        [0.8810, 0.1650],
        [0.8016, 0.2541],
        [0.8558, 0.1894],
        [0.8192, 0.2320]], device='cuda:0', grad_fn=<SigmoidBackward>)
tensor(0.0424, device='cuda:0', grad_fn=<NllLossBackward>)
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1], device='cuda:0')
tensor([[0.6909, 0.3830],
        [0.6478, 0.4288],
        [0.8303, 0.2173],
        [0.8627, 0.1815],
        [0.9055, 0.1321],
        [0.8666, 0.1806],
        [0.8651, 0.1803],
        [0.7956, 0.2686],
        [0.7647, 0.2989],
        [0.7696, 0.2942],
        [0.0853, 0.9281],
        [0.0724, 0.9408]], device='cuda:0', grad_fn=<SigmoidBackward>)
tensor(0.0763, device='cuda:0', grad_fn=<NllLossBackward>)
tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], device='cuda:0')
tensor([[0.3441, 0.7167],
        [0.4472, 0.6216],
        [0.5201, 0.5546],
        [0.3540, 0.6985],
        [0.3753, 0.6834],
        [0.4405, 0.6248],
        [0.3990, 0.6650],
        [0.3791, 0.6748],
        [0.4254, 0.6374],
        [0.3831, 0.6746],
        [0.4258, 0.6366],
        [0.4126, 0.6466]], device='cuda:0', grad_fn=<SigmoidBackward>)
tensor(0.3248, device='cuda:0', grad_fn=<NllLossBackward>)
tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], device='cuda:0')
tensor([[0.4144, 0.6434],
        [0.4688, 0.5958],
        [0.3848, 0.6856],
        [0.4466, 0.6175],
        [0.3297, 0.7251],
        [0.4586, 0.6066],
        [0.4179, 0.6407],
        [0.4312, 0.6320],
        [0.3904, 0.6696],
        [0.3267, 0.7306],
        [0.3644, 0.6938],
        [0.4434, 0.6192]], device='cuda:0', grad_fn=<SigmoidBackward>)
tensor(0.3195, device='cuda:0', grad_fn=<NllLossBackward>)
tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], device='cuda:0')
tensor([[0.2519, 0.7951],
        [0.1812, 0.8526],
        [0.1972, 0.8367],
        [0.1687, 0.8645],
        [0.0778, 0.9354],
        [0.4615, 0.6026],
        [0.2855, 0.7659],
        [0.1846, 0.8480],
        [0.0836, 0.9345],
        [0.9833, 0.0245],
        [0.9982, 0.0029],
        [0.9930, 0.0106]], device='cuda:0', grad_fn=<SigmoidBackward>)
tensor(0.0792, device='cuda:0', grad_fn=<NllLossBackward>)
tensor([0, 0, 0], device='cuda:0')
tensor([[0.8743, 0.1686],
        [0.8599, 0.1915],
        [0.8607, 0.1865]], device='cuda:0', grad_fn=<SigmoidBackward>)
tensor(0.0344, device='cuda:0', grad_fn=<NllLossBackward>)
train >>> fold 1/5, epoch: 1/24, patient 1/24, mean_loss 0.0855, mean_acc 1.0000
