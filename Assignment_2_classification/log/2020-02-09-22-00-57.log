2020-02-09-22-00-57
train_bs.py
--------------------------------------------------------------------------------------------------------------------
batchSize: 28
bottleneckFeatures: 0
brightness: [-0.2, 0.2]
contrast: [-0.2, 0.2]
dir_lf: D:\Data\cs-8395-dl
dir_project: ..
encoder: resnet18
epoch: 20
folderData: assignment2_data
lr: 0.001
overrideLR: 1
resize: 256
resume_from: None
to_ram: 0
--------------------------------------------------------------------------------------------------------------------
creating directory to save model at D:\Data\cs-8395-dl\model\2020-02-09-22-00-57
balanced_max:  6130
number of samples in balanced dataset 42910
train samples 9015
validation samples 1000
train >>> epoch: 1/20, batch: 1/32, mean_loss: 2.0150, mean_acc: 0.1429
train >>> epoch: 1/20, batch: 2/32, mean_loss: 1.7936, mean_acc: 0.2679
train >>> epoch: 1/20, batch: 3/32, mean_loss: 1.6580, mean_acc: 0.3333
train >>> epoch: 1/20, batch: 4/32, mean_loss: 1.6718, mean_acc: 0.3393
train >>> epoch: 1/20, batch: 5/32, mean_loss: 1.8575, mean_acc: 0.3429
train >>> epoch: 1/20, batch: 6/32, mean_loss: 1.8011, mean_acc: 0.3690
train >>> epoch: 1/20, batch: 7/32, mean_loss: 1.8005, mean_acc: 0.3622
train >>> epoch: 1/20, batch: 8/32, mean_loss: 1.7406, mean_acc: 0.3705
train >>> epoch: 1/20, batch: 9/32, mean_loss: 1.6999, mean_acc: 0.3889
train >>> epoch: 1/20, batch: 10/32, mean_loss: 1.6825, mean_acc: 0.3857
train >>> epoch: 1/20, batch: 11/32, mean_loss: 1.6443, mean_acc: 0.3896
train >>> epoch: 1/20, batch: 12/32, mean_loss: 1.6273, mean_acc: 0.3958
train >>> epoch: 1/20, batch: 13/32, mean_loss: 1.6105, mean_acc: 0.3984
train >>> epoch: 1/20, batch: 14/32, mean_loss: 1.5874, mean_acc: 0.4056
train >>> epoch: 1/20, batch: 15/32, mean_loss: 1.5839, mean_acc: 0.4048
train >>> epoch: 1/20, batch: 16/32, mean_loss: 1.5582, mean_acc: 0.4174
train >>> epoch: 1/20, batch: 17/32, mean_loss: 1.5377, mean_acc: 0.4265
train >>> epoch: 1/20, batch: 18/32, mean_loss: 1.5167, mean_acc: 0.4345
train >>> epoch: 1/20, batch: 19/32, mean_loss: 1.5180, mean_acc: 0.4361
train >>> epoch: 1/20, batch: 20/32, mean_loss: 1.5181, mean_acc: 0.4357
train >>> epoch: 1/20, batch: 21/32, mean_loss: 1.4975, mean_acc: 0.4422
train >>> epoch: 1/20, batch: 22/32, mean_loss: 1.4834, mean_acc: 0.4464
train >>> epoch: 1/20, batch: 23/32, mean_loss: 1.4766, mean_acc: 0.4472
train >>> epoch: 1/20, batch: 24/32, mean_loss: 1.4843, mean_acc: 0.4479
train >>> epoch: 1/20, batch: 25/32, mean_loss: 1.4797, mean_acc: 0.4486
train >>> epoch: 1/20, batch: 26/32, mean_loss: 1.4729, mean_acc: 0.4478
train >>> epoch: 1/20, batch: 27/32, mean_loss: 1.4717, mean_acc: 0.4471
train >>> epoch: 1/20, batch: 28/32, mean_loss: 1.4666, mean_acc: 0.4464
train >>> epoch: 1/20, batch: 29/32, mean_loss: 1.4556, mean_acc: 0.4520
train >>> epoch: 1/20, batch: 30/32, mean_loss: 1.4552, mean_acc: 0.4512
train >>> epoch: 1/20, batch: 31/32, mean_loss: 1.4581, mean_acc: 0.4562
train >>> epoch: 1/20, batch: 32/32, mean_loss: 1.4484, mean_acc: 0.4609
train >>> epoch: 1/20, batch: 33/32, mean_loss: 1.4451, mean_acc: 0.4621
train >>> epoch: 1/20, batch: 34/32, mean_loss: 1.4443, mean_acc: 0.4622
0.46218487394957986
valid >>> epoch: 1/20, mean_loss: 1.1988, mean_acc: 0.5710
recall_macro_valid: 0.293475
criteria decreased from inf to 1.1988, saving best model at D:\Data\cs-8395-dl\model\2020-02-09-22-00-57\2020-02-09-22-00-57_resnet18_best.pt
train >>> epoch: 2/20, batch: 1/32, mean_loss: 1.4038, mean_acc: 0.4286
train >>> epoch: 2/20, batch: 2/32, mean_loss: 1.2805, mean_acc: 0.5179
train >>> epoch: 2/20, batch: 3/32, mean_loss: 1.3313, mean_acc: 0.4762
train >>> epoch: 2/20, batch: 4/32, mean_loss: 1.3190, mean_acc: 0.4732
train >>> epoch: 2/20, batch: 5/32, mean_loss: 1.2578, mean_acc: 0.5143
train >>> epoch: 2/20, batch: 6/32, mean_loss: 1.2222, mean_acc: 0.5357
train >>> epoch: 2/20, batch: 7/32, mean_loss: 1.2036, mean_acc: 0.5459
train >>> epoch: 2/20, batch: 8/32, mean_loss: 1.1905, mean_acc: 0.5580
train >>> epoch: 2/20, batch: 9/32, mean_loss: 1.2189, mean_acc: 0.5556
train >>> epoch: 2/20, batch: 10/32, mean_loss: 1.2034, mean_acc: 0.5714
train >>> epoch: 2/20, batch: 11/32, mean_loss: 1.1794, mean_acc: 0.5812
train >>> epoch: 2/20, batch: 12/32, mean_loss: 1.1852, mean_acc: 0.5804
train >>> epoch: 2/20, batch: 13/32, mean_loss: 1.1830, mean_acc: 0.5879
train >>> epoch: 2/20, batch: 14/32, mean_loss: 1.1875, mean_acc: 0.5816
train >>> epoch: 2/20, batch: 15/32, mean_loss: 1.2211, mean_acc: 0.5786
train >>> epoch: 2/20, batch: 16/32, mean_loss: 1.2262, mean_acc: 0.5737
train >>> epoch: 2/20, batch: 17/32, mean_loss: 1.2069, mean_acc: 0.5798
train >>> epoch: 2/20, batch: 18/32, mean_loss: 1.1982, mean_acc: 0.5794
train >>> epoch: 2/20, batch: 19/32, mean_loss: 1.2078, mean_acc: 0.5789
train >>> epoch: 2/20, batch: 20/32, mean_loss: 1.2102, mean_acc: 0.5804
train >>> epoch: 2/20, batch: 21/32, mean_loss: 1.2018, mean_acc: 0.5850
train >>> epoch: 2/20, batch: 22/32, mean_loss: 1.1961, mean_acc: 0.5860
train >>> epoch: 2/20, batch: 23/32, mean_loss: 1.1958, mean_acc: 0.5839
train >>> epoch: 2/20, batch: 24/32, mean_loss: 1.1878, mean_acc: 0.5848
train >>> epoch: 2/20, batch: 25/32, mean_loss: 1.1961, mean_acc: 0.5829
train >>> epoch: 2/20, batch: 26/32, mean_loss: 1.1855, mean_acc: 0.5879
train >>> epoch: 2/20, batch: 27/32, mean_loss: 1.1823, mean_acc: 0.5860
train >>> epoch: 2/20, batch: 28/32, mean_loss: 1.1797, mean_acc: 0.5867
train >>> epoch: 2/20, batch: 29/32, mean_loss: 1.1807, mean_acc: 0.5862
train >>> epoch: 2/20, batch: 30/32, mean_loss: 1.1928, mean_acc: 0.5845
train >>> epoch: 2/20, batch: 31/32, mean_loss: 1.1894, mean_acc: 0.5818
train >>> epoch: 2/20, batch: 32/32, mean_loss: 1.1861, mean_acc: 0.5837
train >>> epoch: 2/20, batch: 33/32, mean_loss: 1.1759, mean_acc: 0.5887
train >>> epoch: 2/20, batch: 34/32, mean_loss: 1.1745, mean_acc: 0.5893
0.5892857142857143
valid >>> epoch: 2/20, mean_loss: 2.5062, mean_acc: 0.3550
recall_macro_valid: 0.386822
train >>> epoch: 3/20, batch: 1/32, mean_loss: 0.8813, mean_acc: 0.7500
train >>> epoch: 3/20, batch: 2/32, mean_loss: 0.9296, mean_acc: 0.7143
train >>> epoch: 3/20, batch: 3/32, mean_loss: 1.0999, mean_acc: 0.6548
train >>> epoch: 3/20, batch: 4/32, mean_loss: 1.0874, mean_acc: 0.6607
train >>> epoch: 3/20, batch: 5/32, mean_loss: 1.0627, mean_acc: 0.6643
train >>> epoch: 3/20, batch: 6/32, mean_loss: 1.0909, mean_acc: 0.6488
train >>> epoch: 3/20, batch: 7/32, mean_loss: 1.0968, mean_acc: 0.6531
train >>> epoch: 3/20, batch: 8/32, mean_loss: 1.0966, mean_acc: 0.6563
train >>> epoch: 3/20, batch: 9/32, mean_loss: 1.0713, mean_acc: 0.6706
train >>> epoch: 3/20, batch: 10/32, mean_loss: 1.0785, mean_acc: 0.6714
train >>> epoch: 3/20, batch: 11/32, mean_loss: 1.0737, mean_acc: 0.6688
train >>> epoch: 3/20, batch: 12/32, mean_loss: 1.0432, mean_acc: 0.6726
train >>> epoch: 3/20, batch: 13/32, mean_loss: 1.0580, mean_acc: 0.6566
train >>> epoch: 3/20, batch: 14/32, mean_loss: 1.0884, mean_acc: 0.6505
train >>> epoch: 3/20, batch: 15/32, mean_loss: 1.0796, mean_acc: 0.6476
train >>> epoch: 3/20, batch: 16/32, mean_loss: 1.0717, mean_acc: 0.6518
train >>> epoch: 3/20, batch: 17/32, mean_loss: 1.0739, mean_acc: 0.6534
train >>> epoch: 3/20, batch: 18/32, mean_loss: 1.0849, mean_acc: 0.6429
train >>> epoch: 3/20, batch: 19/32, mean_loss: 1.1077, mean_acc: 0.6353
train >>> epoch: 3/20, batch: 20/32, mean_loss: 1.1001, mean_acc: 0.6321
train >>> epoch: 3/20, batch: 21/32, mean_loss: 1.1041, mean_acc: 0.6259
train >>> epoch: 3/20, batch: 22/32, mean_loss: 1.1166, mean_acc: 0.6218
train >>> epoch: 3/20, batch: 23/32, mean_loss: 1.1114, mean_acc: 0.6227
train >>> epoch: 3/20, batch: 24/32, mean_loss: 1.1229, mean_acc: 0.6146
train >>> epoch: 3/20, batch: 25/32, mean_loss: 1.1259, mean_acc: 0.6143
train >>> epoch: 3/20, batch: 26/32, mean_loss: 1.1279, mean_acc: 0.6140
train >>> epoch: 3/20, batch: 27/32, mean_loss: 1.1248, mean_acc: 0.6124
train >>> epoch: 3/20, batch: 28/32, mean_loss: 1.1345, mean_acc: 0.6071
train >>> epoch: 3/20, batch: 29/32, mean_loss: 1.1288, mean_acc: 0.6059
train >>> epoch: 3/20, batch: 30/32, mean_loss: 1.1249, mean_acc: 0.6095
train >>> epoch: 3/20, batch: 31/32, mean_loss: 1.1246, mean_acc: 0.6083
train >>> epoch: 3/20, batch: 32/32, mean_loss: 1.1235, mean_acc: 0.6083
train >>> epoch: 3/20, batch: 33/32, mean_loss: 1.1173, mean_acc: 0.6093
train >>> epoch: 3/20, batch: 34/32, mean_loss: 1.1184, mean_acc: 0.6113
0.6113445378151261
